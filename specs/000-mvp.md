# MVP

## Description

This document contains the basic roadmap for the minimal viable product (MVP).

## Task List

### Infrastructure & Setup

- [x] **Initialize project structure**
  - [x] Create Astro 5.x project with React 19 islands
  - [x] Add home page with basic info from README
    - [x] Basic marketing blurb
    - [x] Describe core values
    - [x] Large input at the top of the page - "What are you looking for?"
  - [x] Setup TypeScript strict mode
  - [x] Configure Tailwind CSS 4.x
  - [x] Add basic folder structure (components, layouts, lib)
  - [x] Store platform name as environment variable, so it can easily be changed in the future
  - [x] Eslint config
  - [x] Prettier config
  - [x] Add GitHub actions for
    - [x] Linting
    - [x] Type checking
    - [x] Verify formatting
  - [x] Include PWA configuration

- [x] **Basic theming system**
  - [x] Add basic system for theming from the get-go
  - [x] Implement modular theming system which makes it easy to define more themes in the future
  - [x] Save selected user theme in local storage
  - [x] Create 4 themes with distinct color palettes
    - [x] Dusk (default, dark) - Blue primary, dusk orange secondary
    - [x] Ember (dark) - Orange primary, burnt orange secondary
    - [x] Ocean (light) - Blue primary, teal secondary
    - [x] Forest (light) - Green primary, tree bark brown secondary
  - [x] Implement SSR-safe theme initialization to prevent FOUC
  - [x] Add theme selector component with visual previews
  - [x] Use CSS custom properties for easy theme switching
  - [x] Apply theme colors to navbar with gradient effects and hover accents
  - [x] Centralize theme configuration in single source of truth

- [x] **Setup testing framework**
  - [x] Configure Vitest for unit tests
  - [x] Configure Playwright for E2E tests
  - [x] Add basic test structure
  - [x] Add simple unit tests for any existing logic
  - [x] Add simple E2E test that verifies theme selector

- [x] **Setup Supabase integration**
  - [x] Init Supabase project with the CLI
  - [x] Setup Supabase preview on each pull request
  - [x] Setup GitHub workflow to configure Cloudflare preview deployments to point at the correct Supabase preview database
  - [x] Update `INFRASTRUCTURE.md` with Supabase database information

- [x] **Database migrations**
  - [x] Remove temporary Supabase test page
  - [x] Create initial declarative schemas
  - [x] Include RLS
  - [x] Use Supabase CLI to generate initial migrations

- [x] **Seed data**
  - [x] Create scripts for adding basic seed data in preview branches

- [ ] **Setup Supabase storage**
  - [ ] Configure local Supabase storage configuration
  - [ ] Add RLS policy for avatar images (anyone can view)
  - [ ] Add RLS policy for item images (matches RLS policy of item)
  - [ ] Add RLS policy for message images (matches RLS policy of message)
  - [ ] Add images to seed data
    - [ ] Avatars
    - [ ] Item images

- [ ] **Setup local development environment**
  - [ ] Set up scripts in `package.json` to trigger important supabase CLI commands
    - [ ] Replace `dev` with `start:frontend`
    - [ ] Replace `build` with `build:frontend`
    - [ ] Remove `preview`
    - [ ] Remove `test` (we already have `test:unit`)
    - [ ] Remove `test:watch`
    - [ ] Add `start:backend`
    - [ ] Add `stop:backend`
  - [ ] Update "Getting Started" section in `CONTRIBUTING.md`
  - [ ] Update `AGENTS.md` to mention current `npm run` scripts

### Static Pages

- [x] **Content policy**
  - [x] A page describing all items that are acceptable to be listed on the market
  - [x] Include contact info for requesting more items to be added to acceptable list

- [x] **About page**
  - [x] Background info
  - [x] Link to creator of the site - https://kwila.cloud
  - [x] Contact info

### Authentication System

- [ ] **Setup Supabase email auth**
  - [ ] Configure Supabase project with email OTP
  - [ ] Create initial user from Supabase dashboard
  - [ ] Create auth layout wrapper
  - [ ] Implement route protection middleware
  - [ ] Add user session verification
  - [ ] Implement basic login flow for existing user
    - [ ] Trigger email OTP
    - [ ] Verify OTP
    - [ ] View basic auth-only dashboard
  - [ ] Update `INFRASTRUCTURE.md` with Supabase auth information

- [ ] **Create invite validation system**
  - [ ] Implement invite code generation
  - [ ] Add invite usage tracking

- [ ] **Build signup flow**
  - [ ] Create invite code validation page
  - [ ] Implement email OTP verification
  - [ ] Create user record with invited_by relationship
  - [ ] Add initial contact info (default to hidden)
  - [ ] Build basic onboarding flow
    - [ ] Contact visibility settings
    - [ ] About information
    - [ ] Avatar upload

- [ ] **Setup Supabase SMS auth**
  - [ ] Configure Supabase project with SMS OTP
  - [ ] Add Twilio integration for SMS auth
  - [ ] Implement basic login flow for existing user
    - [ ] Trigger SMS OTP
    - [ ] Verify OTP
    - [ ] View basic auth-only dashboard
  - [ ] Add SMS OTP to signup flow

### Core User Management

- [ ] **Implement user profile system**
  - [ ] Create user settings management
  - [ ] Add profile editing functionality
  - [ ] Save selected user theme to user settings
  - [ ] Implement vendor_id uniqueness and user profile pages

- [ ] **Build connection system**
  - [ ] Create connection requests functionality
  - [ ] Implement acceptance/decline flows
  - [ ] Add connection status tracking
  - [ ] Create connection list components

### Item Management System

- [ ] **Create category management**
  - [ ] Create category selection component
  - [ ] Add category filtering and display

- [ ] **Build item creation flow**
  - [ ] Make large input functional (search/buy request creation) on the home page
  - [ ] Create item form component
  - [ ] Implement item validation
  - [ ] Add image upload with compression
  - [ ] User must check box that new item complies with the content policy (include link)

- [ ] **Implement item listing and search**
  - [ ] Create items listing page with filters
  - [ ] Add search functionality
  - [ ] Implement item visibility rules
  - [ ] Create item detail pages
  - [ ] Implement view transition from `ItemCard` to item detail page

- [ ] **Implement watch list**
  - [ ] Allow user to save a search/filter combination for easy access in the future
  - [ ] Allow user to enable weekly notifications for any search in their watch list
  - [ ] Implement CloudFlare worker that goes through each item in the watch list for every user and send notifications that include any new items (added in the past week)

### Messaging System

- [ ] **Create messaging infrastructure**
  - [ ] Setup thread creation logic
  - [ ] Implement message sending/receiving
  - [ ] Add message realtime system
  - [ ] Create thread list interface

- [ ] **Build message images support**
  - [ ] Implement image upload for messages
  - [ ] Create message composition UI

### UI & Polish

- [ ] **Create main navigation and layouts**
  - [ ] Build header component with navigation
  - [ ] Create dashboard layout
  - [ ] Implement responsive design
  - [ ] Add custom 404 page

- [ ] **Implement item feed and vendor pages**
  - [ ] Create vendor profile routing (/{vendor_id})
  - [ ] Build item feed with connection prioritization
  - [ ] Add vendor showcase/portfolio display

- [ ] **Add error handling and user feedback**
  - [ ] Implement comprehensive error boundaries
  - [ ] Add loading states and progress indicators
  - [ ] Create user-friendly error messages
  - [ ] Add form validation feedback

- [ ] **Content policy violations**
  - [ ] Implement simple method for authenticated users to anonymously mark concerns about content policy violations
  - [ ] Email system admin when items are marked as concerning

### Testing & Quality

- [ ] **Add comprehensive test coverage**
  - [ ] Write unit tests for utilities and components
  - [ ] Create E2E tests for critical user flows
  - [ ] Add authentication flow tests
  - [ ] Test item creation and messaging flows

- [ ] **Security and performance validation**
  - [ ] Verify RLS policies work correctly
  - [ ] Test visibility rules and anonymity
  - [ ] Performance testing for image uploads
  - [ ] Security audit of auth flows

- [ ] **Alpha testing preparation**
  - [ ] Setup monitoring and logging
  - [ ] Create admin tools for user management
  - [ ] Add content moderation basics
  - [ ] Prepare for alpha tester onboarding

### Final Branding & Polish

- [ ] **Logo and icon assets**
  - [ ] Design or commission logo (once final name is determined)
  - [ ] Generate PWA icon files (icon-192.png, icon-512.png)
  - [ ] Create favicon from logo
  - [ ] Update manifest with proper branding
  - [ ] Add logo to navigation/header
